=pod

=head1 NAME

OSSL_CMP_MSG_protect,
OSSL_CMP_MSG_add_extraCerts
- functions manipulating CMP message protection

=head1 SYNOPSIS

  #include "cmp_int.h"

  int OSSL_CMP_MSG_protect(OSSL_CMP_CTX *ctx, OSSL_CMP_MSG *msg);
  int OSSL_CMP_MSG_add_extraCerts(OSSL_CMP_CTX *ctx, OSSL_CMP_MSG *msg);

=head1 DESCRIPTION

OSSL_CMP_MSG_protect() protects the given message deciding on the algorithm
depending on the available context information:  If there is a secretValue it
selects PBMAC. If not and there is a clCert it selects Signature.  Generates and
sets the protection to the given message.

OSSL_CMP_MSG_add_extraCerts() fills the extraCerts field in the message.

=head1 NOTES

CMP is defined in RFC 4210 (and CRMF in RFC 4211).

The implementation of CMP for OpenSSL is still work in progress. The API
might change every release!

=head1 RETURN VALUES

See the individual functions above.

=head1 COPYRIGHT

Copyright 2007-2019 The OpenSSL Project Authors. All Rights Reserved.

Licensed under the Apache License 2.0 (the "License").  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
L<https://www.openssl.org/source/license.html>.

=cut
